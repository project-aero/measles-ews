---
fontsize: 11pt
geometry: margin=1in
header-includes:
 - \usepackage{amsmath,amssymb}
 - \usepackage{changepage}
 - \usepackage{textcomp,marvosym}
 - \usepackage{cite}
 - \usepackage{nameref,hyperref}
 - \usepackage[left]{lineno}
 - \usepackage{microtype}
 - \DisableLigatures[f]{encoding = *, family = * }
 - \usepackage[table]{xcolor}
 - \usepackage{array}
 - \usepackage[font=small,labelfont=bf]{caption}
 - \usepackage{lastpage,fancyhdr,graphicx}
 - \usepackage{epstopdf}
 - \usepackage{mathptmx} 
 - \usepackage{longtable,booktabs}
 - \usepackage[symbol]{footmisc}
layout: 11pt
linkcolor: black
output:
  pdf_document:
    fig_caption: yes
    keep_tex: no
urlcolor: black
---
\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\raggedright
\vspace*{0.2in}

<!-- % Title must be 250 characters or less. -->
\begin{centering}

{\LARGE
\textbf\newline{Early warning signals anticipate emergence\\of measles in empirically-based models} 
}

\vspace{2em}

Andrew T. Tredennick\textsuperscript{1,2}\footnote[1]{Corresponding author: atredenn@gmail.com},
Pejman Rohani\textsuperscript{1,2},
Eamon O'Dea\textsuperscript{1,2},
Tobias Brett\textsuperscript{1,2},
\& John M. Drake\textsuperscript{1,2}
\\
\bigskip
\textsuperscript{1} \small\emph{Odum School of Ecology, University of Georgia, Athens, GA, USA} \\
\textsuperscript{2} \small\emph{Center for the Ecology of Infectious Diseases, University of Georgia, Athens, GA, USA}

\end{centering}



# Abstract
Forecasting the trajectory of infectious disease outbreaks over time is a fundamental challenge facing society.

\linenumbers

# Introduction

Theory shows that epidemic transitions can be anticipated by trends in the statistical properties of disease time series (AERO papers).
The existence of statistical trends in the data that precede critical transitions, so-called 'early warning signals' (EWS), imply that we may be able to anticipate disease emergence and outbreaks.
The end goal is a model-independent detection system, where statistical properties of disease surveilence data can trigger warnings of impending outbreaks without the need to fit mechanistic models of disease transmission (Han and Drake 2017).

However, there is currently a gap between the theoretical work, which has relied on knowing the underlying disease dynamics, and the eventual goal of applying EWS in real-world situations where the underlying disease dynamics may be unknown.
Theoretical development of EWS has focused on anticipating when the population becomes supercritical, when $\mathcal{R}_0 > 1$, after which an outbreak is inevitable, perhaps with some bifurcation delay (Dibble et al. 2016).
Knowing the value of $\mathcal{R}_0$ through time makes it possible to test the accuracy of EWS that are estimated from state variables alone.
Empirical application of EWS does not require knowing the value of $\mathcal{R}_0$ through time, meaning that "tests" require making assumptions about when critical transitions occur.
Whether EWS track and/or anticipate underlying dynamics of real disease time series remains unknown, and is a critical knowledge gap that must be filled before EWS can confidently be deployed.

To fill this gap we will fit a mechanistic model to incidence data of measles in Niger to estimate the temporal epidemiology of the disease, yielding the very same parameters that are known in data-free modeling studies.
In particular, we are interested in the correlation between EWS and the time-varying repreoductive ratio, known as the effective reprodutive ratio $\left(\mathcal{R}_E\right)$.
If EWS and $\mathcal{R}_E$ are significantly and positively correlated, then we have empirical evidence that EWS are applicable in real-world settings.
If EWS and $\mathcal{R}_E$ are negatively correlated or not significantly posivitely correlated, then we have evidence that EWS may not be applicable in certain settings.

# Materials and Methods

## Data
We used weekly measles case report data from four Nigerien cities, collected over an 11 year period (1995-2005) (Figure \ref{fig:data}).
These data are ideal for stress testing EWS because each city has different population sizes, has different dynamics in terms of size of outbreaks and length of inter-epidemic periods, and each time series has different amounts of demographic stochasticity due to differences in population size.
The data come from [*somewhere/someone*], and used here with permission from [*somewhere/someone*].

\begin{figure}[!ht]
\centering
\includegraphics[width=\textwidth]{../figures/map-and-series.pdf}
\caption{(A) Locations and population sizes (in parantheses) of our four focal cities in Niger. (B) Time series of reported cases (yellow solid lines) and the 95\% prediction intervals for one-step-ahead forecasts from our fitted SEIR models for each city.}
\label{fig:data}
\end{figure}

## Stochastic *SEIR* model
The model is a discrete-time approximation of a continuous-time SEIR model with limited demography, specified as a set of difference equations,

\begin{align}
S_{t+dt} &= n_{S,t} - n_{E,t} \\
E_{t+dt} &= n_{E,t} - n_{I,t} \\
I_{t+dt} &= n_{I,t} + n_{O,t} - n_{R,t},
\end{align}

\noindent{}where $\textbf{n}_t$ are random variables representing the number of individuals transitioning into or out of each class at each timestep $t \rightarrow t+dt$.
$n_{S}$ is the number of births, $n_{E}$ is the number of newly infected individuals that have the disease but are not infectious, $n_{I}$ is the number of newly infectious indiviuals, $n_{O}$ is the number of imported infections, and $n_{R}$ is the number of newly recovered individuals who are no longer infectious and have life-long immunity.
The stochastic random variables are specified as follows:

\begin{align}
n_{S,t} &\sim \text{Poisson}(\mu_t N_t \times dt) \\
n_{E,t} &\sim \text{Binomial}(\lambda_{E,t}, S_{t}) \\
n_{I,t} &\sim \text{Binomial}(\lambda_{I,t}, E_{t}) \\
n_{O,t} &\sim \text{Poisson}(\psi \times dt) \\
n_{R,t} &\sim \text{Binomial}(\lambda_{R,t}, I_{t}),
\end{align}

\noindent{}where $\mu_t$ is the birth rate at time *t*, $\psi$ is the rate of imported infections, and $\lambda_E$, $\lambda_I$, and $\lambda_R$ are the probabilities of exposure, becoming infectious, and recovery, respectively.
These probabilities reflect the processes of tranmission, transition from the latent period to the infectious period, and recovery, which we model as:

\begin{align}
\lambda_{E,t} &= 1 - e^{-\frac{\beta_t I_t dt}{N_t}} \\
\lambda_{I,t} &= 1 - e^{-\eta E_{t} dt} \\
\lambda_{R,t} &= 1 - e^{-\gamma I_{t} dt},
\end{align}

\noindent{}where $\beta_t$ is time-varying rate of transmission, $\eta$ is time-invariant rate from the exposed class to the infectious class, and $\gamma$ is time-invariant recovery rate.
We model rate of transmission as:

\begin{equation}
\beta_t = \beta \left(1 + \sum^6_{i=1} q_i \xi_{i_{t}} \right) \Gamma_t.
\end{equation}

$\beta$ is the mean transmission rate, $\psi$ accounts for measles infections from external sources that are not part of the local dynamics, and the term $\sum^6_{i=1} q_i \xi_{i_{t}}$ is a B-spline to model seasonality in transmission.
The B-spline bases ($\xi_{i_{t}}$) are periodic with a 1 year period.
The transmission rate ($\beta_t$) is also subject to stochastic process noise at each time step, $\Gamma_t$, which we model as a gamma-distributed white (temporally uncorrelated) noise with mean 1 and variance $\sigma^2$ (Bret√≥ and Ionides 2011).

We do not include a death process in the model because the rate of infection is much faster than the rate of death.
Excluding deaths means we can avoid making further assumptions about demographic rates -- we are already making assumptions about birth rates (e.g., the rate is the same across cities, but with city-specific population size).
We model demographic stochasticity in births and imported infections by drawing time-specific values from Poisson distributions.
Transitions in the model are shown in Table 1.
In this model, the effective reproductive ratio at time *t* is: $\mathcal{R}_E(t) = \frac{\beta_t}{\gamma} \frac{S_t}{N_t}$.

We assume observed case reports ($\textbf{y}$) are drawn from a Negative Binomial distribution subject to a constant reporting fraction ($\rho$) and dispersion parameter $\tau$,

\begin{align}
y_t \sim \text{Negative Binomial} \left( \rho I_t, \tau \right).
\end{align}

| Transition | ($\Delta S$, $\Delta E$, $\Delta I$) | Propensity |
| --------------- | ------------ | -------------------------------------------- |
| birth | $(1, 0, 0)$ | $N_t \mu_t$ |
| transmission (deterministic) | $(-1, 1, 0)$ | $SI \beta_t / N_t$ |
| transmission (stochastic) | $(-k, k, 0)$ | $\frac{S}{k}\sum^k_{j=0} \left(\begin{matrix}k\\j\end{matrix} \right) (-1)^{k-j+1} \tau_{\text{f}}^{-1} \text{ln}(1 + (\beta_tI/N_t)) \tau_{\text{f}} (S-j)$ |
| symptomatic (infectious) | $(0,-1,1)$ | $E\eta$
| imported infections | $(0, 0, 1)$ | $\psi_t$ |
| recovery | $(0, 0, -1)$ | $I\gamma$ |

Table: Transitions in the SEIR model. We show the determinstic transmission rate for clarity, but our model uses the stochastic tranmission rate.

<!-- \begin{table}[!ht] -->
<!-- \centering -->
<!-- \caption{Transitions in the SI model. We show the determinstic transmission rate for clarity, but our model uses the stochastic tranmission rate.} -->
<!-- \begin{tabular}{lll} -->
<!-- \toprule -->
<!-- Transition & ($\Delta S$, $\Delta I$) & Propensity \\ -->
<!-- \midrule -->
<!-- birth & $(1, 0)$ & $N_t \mu$ \\ -->
<!-- imported infections & $(0, 1)$ & $\psi_t$ \\ -->
<!-- transmission (deterministic) & $(-1, 1)$ & $SI \beta_t / N_t$ \\ -->
<!-- transmission (stochastic) & $(-k, k)$ & $\frac{S}{k}\sum^k_{j=0} \left(\begin{matrix}k\\j\end{matrix} \right) (-1)^{k-j+1} \tau_{\text{f}}^{-1} \text{ln}(1 + (\beta_tI/N_t)) \tau_{\text{f}} (S-j)$ \\ -->
<!-- recovery & $(0, -1)$ & $I\gamma$ \\ -->
<!-- \bottomrule -->
<!-- \end{tabular} -->
<!-- \label{table:model-trans} -->
<!-- \end{table} -->

##  Model fitting and inference

## Model simulations

# Results

Stochastic simulations from sub-critical ($\mathcal{R}_{E(t)} \ll 0$) to near-critical dynamics ($\mathcal{R}_{E(t)} \approx 1$) differed among the four cities (Figure ~\ref{fig:re-sims}).

\begin{figure}[!ht]
\centering
\includegraphics[width=\textwidth]{../figures/re-simulated-series.pdf}
\caption{Yearly average $\mathcal{R}_{E(t)}$ (blue lines) across 500 models simulations at the MLE parameters and 20 representations simulations (grey lines) for each city. The horizontal dashed line shows where $\mathcal{R}_{E(t)} = 1$. The vertical solid red lines show the time point at which yearly average $\mathcal{R}_{E(t)} \ge 1$. The time periods before the red line for each city were used for testing early warning signals.}
\label{fig:re-sims}
\end{figure}

\begin{figure}[!ht]
\centering
\includegraphics[width=\textwidth]{../figures/sim-emergence-aucs.pdf}
\caption{Performance of EWS calculated over two windows (far and near $\mathcal{R}_{E(t)} = 1$) from the time series of 500 simulated dynamics. The two windows were defined as equally-sized windows over the course of the time series up to $\mathcal{R}_{E(t)} = 1$ (red lines in Figure ~\ref{fig:re-sims})}
\label{fig:aucs}
\end{figure}


\nolinenumbers

# Acknowledgments
This research was funded by the National Institute of General Medical Sciences of the National Institutes of Health (Award Number U01GM110744).
The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.
This work was done on the Olympus High Performance Compute Cluster located at the Pittsburgh Supercomputing Center at Carnegie Mellon University, which is supported by National Institute of General Medical Sciences Modeling Infectious Disease Agent Study (MIDAS) Informatics Services Group grant 1U24GM110707.

